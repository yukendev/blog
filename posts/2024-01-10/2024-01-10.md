---
title: 'Render.comã¨LINE APIã§ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’ä½œæˆã™ã‚‹'
date: '2024-01-10'
slug: 'tips-render-com-line-api'
category: 'tech'
tags:
  - 'JavaScript'
  - 'Node.js'
description: 'æ¯é€±åœŸæ›œæ—¥ã«LINEã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ã§é€ä¿¡ã™ã‚‹LINE botã‚’ä½œæˆã—ã¾ã—ãŸã€‚Node.jsã§Render.comã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã£ã¦å®šæœŸå‡¦ç†ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚'
---

# çµŒç·¯

ç¾åœ¨è‡ªåˆ†ãŒæ‰€å±ã—ã¦ã„ã‚‹çµ„ç¹”ã®ã€NPO ã—ã‚“ã˜ã‚“ãƒ»ã‚‹ã„ã€ã§ã¯ã€ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦è‰²ã€…ãªå¹´é½¢å±¤ã®äººãŒåœ¨ç±ã—ã¦ãŠã‚Šã€æ¥­å‹™ã®ä¸»ãªé€£çµ¡æ‰‹æ®µã¨ã—ã¦ LINE ã‚’ç”¨ã„ã¦ã„ã¾ã™ã€‚ãã®ä¸­ã§ã€ã€æ¥­å‹™ã®è‡ªå‹•åŒ–ã€ã€ã€ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã€ãŒã‚ã£ãŸã‚‰ä¾¿åˆ©ã ã­ã¨ã„ã†è©±ã«ãªã‚Šã€LINE bot ã‚’è‡ªåˆ†ãŒå®Ÿè£…ã™ã‚‹ã“ã¨ã«ãªã£ãŸã®ã§è¨˜äº‹ã«æ®‹ã—ã¾ã™ã€‚

# ã‚„ã‚ŠãŸã„ã“ã¨

ã¾ãšã¯æœ€å°é™ã®æ©Ÿèƒ½ã‚’æ­è¼‰ã—ãŸã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã‚ŠãŸã„ã€‚ã¨ã„ã†ã“ã¨ã§è¦ä»¶ã¯

- æ¯é€±åœŸæ›œæ—¥ã« LINE ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’é€ä¿¡

ã®ã¿ã§ã™ã€‚`JavaScript` ã—ã‹æ™®æ®µè§¦ã£ã¦ã„ãªã„ã®ã§ã€`Node.js` ã§ä½œã£ã¦ã„ãã¾ã™ã€‚

# ä½¿ç”¨ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹

LINE API

https://developers.line.biz/ja/services/messaging-api/

Render.com

https://render.com/

## LINE API

LINE ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™ã€‚ç„¡æ–™ãƒ—ãƒ©ãƒ³ã ã¨æœˆã« 200 é€šã®ã—ã‹é€ä¿¡ã™ã‚‹ã“ã¨ãŒã§ããªã„ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ã—ã‹ã‚‚ 5 äººã®ã‚°ãƒ«ãƒ¼ãƒ—ã« 1 é€šé€ã‚‹ã¨ 5 é€šæ‰±ã„ã«ãªã‚‹ã½ã„ã®ã§ãã‚Œã‚‚è¦æ³¨æ„ã€‚ãŸã ã€ä»Šå›ã®è¦ä»¶ã ã¨ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§ååˆ†ã§ã™ã€‚

æ–™é‡‘ãƒ—ãƒ©ãƒ³

https://www.lycbiz.com/jp/service/line-official-account/plan/

LINE API ã«ã¤ã„ã¦ã¯è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã‚‹ã®ã§ã€è©³ç´°ã¯ãã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ã€‚

https://www.yukendev.com/blogs/tips-line-api

## Render.com

å®šæœŸå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€Render.com ã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã„ã¾ã™ã€‚å®šæœŸå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã¯ã„ãã¤ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã‚ã¡ã‚ƒã‚ã¡ã‚ƒç°¡å˜ã«ã§ããã†ã ã£ãŸã®ã§ã“ã‚Œã«ã—ã¾ã—ãŸã€‚

è¨˜äº‹ã‚’æ›¸ã„ãŸã®ã§è©³ã—ãã¯ãã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ã€‚

https://www.yukendev.com/blogs/tips-render-com-cron-job

# å®Œæˆå“

https://github.com/yukendev/shin.jing.rui-bot

ç¾çŠ¶æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¦ã€æ¯é€±åœŸæ›œæ—¥ã« LINE ã§ãƒªãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã ã‘ã§ã¯ãªããªã£ã¦ã„ã¾ã™ãŒã€‚ç¨¼åƒä¸­ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

## è©³ç´°

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ãŒæ¯é€±åœŸæ›œæ—¥ã®åˆå‰ 9 æ™‚åŠã«å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚

```tsx
import { sendLineMessage } from '../api/line.js';
import { getWeekOfMonth } from '../utils/date.js';
import dotenv from 'dotenv';

/*
   æ—¥æœ¬æ™‚é–“ã§æ¯é€±åœŸæ›œæ—¥ã®åˆå‰ï¼™æ™‚åŠã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¸ãƒ§ãƒ–
 */
dotenv.config();

const shinjingruiGroupId = process.env.SHINJINGRUI_LINE_GROUP_ID;

if (shinjingruiGroupId !== undefined) {
  const weekOfMonth = getWeekOfMonth();

  if (weekOfMonth === (1 || 3)) {
    // å­¦ç¿’æ”¯æ´&å­ã©ã‚‚é£Ÿå ‚ãŒé–‹å‚¬ã•ã‚Œãªã„åœŸæ›œæ—¥
    sendLineMessage(
      shinjingruiGroupId,
      'æ¥é€±ã®å­¦ç¿’æ”¯æ´ã«å‚åŠ ã§ãã‚‹äººã¯ã€çµµæ–‡å­—ã§åå¿œã‚’ã‚ªãƒã‚¬ã‚¤ã‚·ãƒã‚¹ğŸˆâ€â¬›',
    );
  } else if (weekOfMonth === (2 || 4)) {
    // å­¦ç¿’æ”¯æ´&å­ã©ã‚‚é£Ÿå ‚ãŒé–‹å‚¬ã•ã‚Œã‚‹åœŸæ›œæ—¥
    sendLineMessage(
      shinjingruiGroupId,
      `ä»Šæ—¥ã¯ç¬¬${weekOfMonth}é€±ã®åœŸæ›œæ—¥ã€‚å­¦ç¿’æ”¯æ´ã¨å­ã©ã‚‚é£Ÿå ‚ã®é–‹å‚¬æ—¥ã§ã™ğŸˆâ€â¬›`,
    );
  }
}
```

åƒ•ãŸã¡ã®å›£ä½“ã§ã¯ã€æ¯æœˆç¬¬äºŒã¨ç¬¬å››åœŸæ›œæ—¥ã«å­ã©ã‚‚é”ã®å­¦ç¿’æ”¯æ´äº‹æ¥­ã¨å­ã©ã‚‚é£Ÿå ‚ã‚’é–‹å‚¬ã—ã¦ã„ã¾ã™ã€‚

æ¯é€±æ¥ã‚Œã‚‹äººã‚’ LINE ã§èãã®ãŒå¿˜ã‚ŒãŒã¡ã§ã€æ•°æ—¥å‰ã«ãªã£ã¦äººãŒè¶³ã‚Šãªã„ï¼ï¼Ÿã£ã¦ã„ã†äº‹æ…‹ãŒã‚ã£ãŸã®ã§ã€è‡ªå‹•ã§æ¯é€±ç¬¬ä¸€ã¨ç¬¬ä¸‰åœŸæ›œæ—¥ã«è‡ªå‹•ã§å‚åŠ ã®å‘¼ã³ã‹ã‘ã‚’ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

ä»¥ä¸‹ãŒ LINE API ã®å‘¼ã³å‡ºã—éƒ¨åˆ†ã§ã™ã€‚

```tsx
import https from 'https';

export const sendLineMessage = (id: string, message: string) => {
  const token = process.env.LINE_ACCESS_TOKEN;

  const data = JSON.stringify({
    to: id,
    messages: [
      {
        type: 'text',
        text: message,
      },
    ],
  });
  const options = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      Authorization: `Bearer ${token}`,
    },
  };
  const url = 'https://api.line.me/v2/bot/message/push';
  const request = https.request(url, options);
  request.write(data);
  request.end();
};
```

API ã®å‘¼ã³å‡ºã—ã¨ã¯è¨€ã£ã¦ã‚‚ã€ãŸã ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚“ã ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã£ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚

ä»¥ä¸Šã§ã€æ¯é€±å®šæœŸçš„ã« LINE ã§ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’é€ã‚‹ã‚ˆã†ãªã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

# æœ€å¾Œã«

ã“ã†ã„ã†ã®ä½œã£ã¦ã‚‹æ™‚ãŒä¸€ç•ªæ¥½ã—ã„ã€‚

ã§ã¯

Bye
